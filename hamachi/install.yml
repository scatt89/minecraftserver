---
- name: Get architecture based
  shell: dpkg --print-architecture
  register: architecture_based
  changed_when: false

- name: Install Hamachi for amd64 architecture
  block:
    - name: Install Hamachi from amd64 package
      apt:
        deb: "{{ hamachi_deb_package_url_amd64 }}"
  when: "'amd64' in architecture_based.stdout"

- name: Install Hamachi for armhf architecture
  block:
    - name: Install lsb-base
      apt:
        name: lsb-base
        state: present
    - name: Install Hamachi from armhf package
      apt:
        deb: "{{ hamachi_deb_package_url_armhf }}"
  when: "'armhf' in architecture_based.stdout"

